<!DOCTYPE html> <html lang="en"> <head> <meta http-equiv="Content-Type" content="text/html; charset=UTF-8"> <meta name="google-site-verification" content=""> <meta name="msvalidate.01" content=""> <meta http-equiv="Permissions-Policy" content="interest-cohort=()"> <meta charset="utf-8"> <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"> <meta http-equiv="X-UA-Compatible" content="IE=edge"> <title> Handwritten Digit Classification | Amirhossein Mahmoudi </title> <meta name="author" content="Amirhossein Mahmoudi"> <meta name="description" content="Handwritten Digit Classification on MNIST dataset using Conventional Neural Network in PyTorch"> <meta name="keywords" content="amirhossein-mahmoudi, mahmoudi, am_mahmoudi,"> <meta property="og:site_name" content="Amirhossein Mahmoudi"> <meta property="og:type" content="website"> <meta property="og:title" content="Amirhossein Mahmoudi | Handwritten Digit Classification"> <meta property="og:url" content="https://mamood.ir/projects/Handwritten-Digit-Classification/"> <meta property="og:description" content="Handwritten Digit Classification on MNIST dataset using Conventional Neural Network in PyTorch"> <meta property="og:image" content="https://raw.githubusercontent.com/ammahmoudi/Handwritten-Digit-Classification/main/samples.png"> <meta property="og:locale" content="en"> <meta name="twitter:card" content="summary"> <meta name="twitter:title" content="Handwritten Digit Classification"> <meta name="twitter:description" content="Handwritten Digit Classification on MNIST dataset using Conventional Neural Network in PyTorch"> <meta name="twitter:image" content="https://raw.githubusercontent.com/ammahmoudi/Handwritten-Digit-Classification/main/samples.png"> <meta name="twitter:site" content="@ammahmoodi"> <meta name="twitter:creator" content="@ammahmoodi"> <script type="application/ld+json">
    {
        "author":
        {
            "@type": "Person",
            "name": "Amirhossein Mahmoudi"
        },
        "url": "https://mamood.ir/projects/Handwritten-Digit-Classification/",
        "@type": "WebSite",
        "description": "Handwritten Digit Classification on MNIST dataset using Conventional Neural Network in PyTorch",
        "headline": "Handwritten Digit Classification",
        
        "sameAs": ["https://orcid.org/0009-0006-8879-7932", "https://github.com/ammahmoudi", "https://telegram.me/am_mahmoudi", "https://www.linkedin.com/in/am-mahmoudi", "https://twitter.com/ammahmoodi", "https://instagram.com/am.mahmoudi"],
        
        "name": "Amirhossein Mahmoudi",
        "@context": "https://schema.org"
    }
  </script> <link rel="stylesheet" href="/assets/css/bootstrap.min.css?a4b3f509e79c54a512b890d73235ef04"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/css/mdb.min.css" integrity="sha256-jpjYvU3G3N6nrrBwXJoVEYI/0zw8htfFnhT9ljN3JJw=" crossorigin="anonymous"> <link defer rel="stylesheet" href="/assets/css/academicons.min.css?f0b7046b84e425c55f3463ac249818f5"> <link defer rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css?family=Roboto:300,400,500,700|Roboto+Slab:100,300,400,500,700|Material+Icons&amp;display=swap"> <link defer rel="stylesheet" href="/assets/css/jekyll-pygments-themes-github.css?591dab5a4e56573bf4ef7fd332894c99" media="" id="highlight_theme_light"> <link rel="shortcut icon" href="/assets/img/favicon.png?35f4f1d9ccd51f0ffeea607d2b075320"> <link rel="stylesheet" href="/assets/css/main.css?d41d8cd98f00b204e9800998ecf8427e"> <link rel="canonical" href="https://mamood.ir/projects/Handwritten-Digit-Classification/"> <link defer rel="stylesheet" href="/assets/css/jekyll-pygments-themes-native.css?5847e5ed4a4568527aa6cfab446049ca" media="none" id="highlight_theme_dark"> <script src="/assets/js/theme.js?0afe9f0ae161375728f7bcc5eb5b4ab4"></script> </head> <body class="fixed-top-nav "> <header> <nav id="navbar" class="navbar navbar-light navbar-expand-sm fixed-top" role="navigation"> <div class="container"> <a class="navbar-brand title font-weight-lighter" href="/"> <span class="font-weight-bold">Amirhossein</span> Mahmoudi </a> <button class="navbar-toggler collapsed ml-auto" type="button" data-toggle="collapse" data-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation"> <span class="sr-only">Toggle navigation</span> <span class="icon-bar top-bar"></span> <span class="icon-bar middle-bar"></span> <span class="icon-bar bottom-bar"></span> </button> <div class="collapse navbar-collapse text-right" id="navbarNav"> <ul class="navbar-nav ml-auto flex-nowrap"> <li class="nav-item "> <a class="nav-link" href="/">About </a> </li> <li class="nav-item "> <a class="nav-link" href="/cv/">CV </a> </li> <li class="nav-item "> <a class="nav-link" href="/blog/">blog </a> </li> <li class="nav-item active"> <a class="nav-link" href="/projects/">Projects <span class="sr-only">(current)</span> </a> </li> <li class="nav-item "> <a class="nav-link" href="/portfolio/">Portfolio </a> </li> <li class="nav-item "> <a class="nav-link" href="/publications/">Publications </a> </li> <li class="toggle-container"> <button id="light-toggle" title="Change theme"> <i class="fa-solid fa-moon"></i> <i class="fa-solid fa-sun"></i> </button> </li> </ul> </div> </div> </nav> <progress id="progress" value="0"> <div class="progress-container"> <span class="progress-bar"></span> </div> </progress> </header> <div class="container mt-5" role="main"> <div class="post"> <header class="post-header"> <h1 class="post-title">Handwritten Digit Classification</h1> <p class="post-description">Handwritten Digit Classification on MNIST dataset using Conventional Neural Network in PyTorch</p> </header> <article> <div id="open-in-github"> <table class="table-cv list-group-table"> <tbody> <tr> <td class="list-group-name"><b> <a href="https://github.com/ammahmoudi/Handwritten-Digit-Classification" rel="external nofollow noopener" target="_blank"><i class="fa-brands fa-github"></i> This page is auto-generated. For more info and materials take a look at the original repository.</a> </b></td> </tr> </tbody> </table> </div> <hr> <p>A code that uses PyTorch to build and implement a residual CNN for solving a classification problem. The goal is to classify handwritten digits from 0 to 9 on the MNIST dataset.</p> <h2 id="data-documentation">Data Documentation</h2> <p>The MNIST database of handwritten digits has a training set of 60,000 examples, and a test set of 10,000 examples.</p> <p>Four files are available:</p> <ul> <li>train-images-idx3-ubyte.gz: training set images (9912422 bytes)</li> <li>train-labels-idx1-ubyte.gz: training set labels (28881 bytes)</li> <li>t10k-images-idx3-ubyte.gz: test set images (1648877 bytes)</li> <li>t10k-labels-idx1-ubyte.gz: test set labels (4542 bytes)</li> </ul> <figure> <picture> <source class="responsive-img-srcset" srcset="https://raw.githubusercontent.com/ammahmoudi/Handwritten-Digit-Classification/main/samples-480.webp 480w,https://raw.githubusercontent.com/ammahmoudi/Handwritten-Digit-Classification/main/samples-800.webp 800w,https://raw.githubusercontent.com/ammahmoudi/Handwritten-Digit-Classification/main/samples-1400.webp 1400w," sizes="95vw" type="image/webp"></source> <img src="https://raw.githubusercontent.com/ammahmoudi/Handwritten-Digit-Classification/main/samples.png" class="img-fluid rounded z-depth-1" width="100%" height="auto" alt="samples of MNIST" data-zoomable="" loading="lazy" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> <p>For more information please read the <a href="https://www.kaggle.com/datasets/hojjatk/mnist-dataset" rel="external nofollow noopener" target="_blank">data documentation</a>.</p> <h2 id="code-explanation">Code Explanation</h2> <ul> <li> <p><strong>Setup</strong>: A code block that imports the necessary libraries and modules, such as torch, torchvision, numpy, pandas, etc. It also sets the device to cuda if available, and defines the style for plotting.</p> </li> <li> <strong>Prepare The Data</strong>: A code block that defines a transformation to convert the images to tensors and normalize them. It also reads the MNIST dataset, splits it into train and validation sets, and creates dataloaders for them. It also plots some images from the train set.</li> <li> <strong>Define Model</strong>: A code block that defines a custom model class called ResidualClassifier. It inherits from nn.Module and implements a forward method. The model has several convolutional layers, max pooling layers, residual connections, an adaptive average pooling layer, a linear layer, and ReLU activations. It follows the architecture shown in the schematic diagram.</li> </ul> <figure> <picture> <source class="responsive-img-srcset" srcset="https://raw.githubusercontent.com/ammahmoudi/Handwritten-Digit-Classification/main/Architecture-480.webp 480w,https://raw.githubusercontent.com/ammahmoudi/Handwritten-Digit-Classification/main/Architecture-800.webp 800w,https://raw.githubusercontent.com/ammahmoudi/Handwritten-Digit-Classification/main/Architecture-1400.webp 1400w," sizes="95vw" type="image/webp"></source> <img src="https://raw.githubusercontent.com/ammahmoudi/Handwritten-Digit-Classification/main/Architecture.png" class="img-fluid rounded z-depth-1" width="100%" height="auto" alt="arthitecture" data-zoomable="" loading="lazy" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> <ul> <li> <strong>Train Model</strong>: A code block that instantiates the model, defines the hyperparameters, optimizer, loss function, and other variables. It also defines a function to calculate the accuracy of the model. It then trains the model for several epochs, evaluates it on the validation set, and plots the loss and accuracy curves.</li> </ul> <figure> <picture> <source class="responsive-img-srcset" srcset="https://raw.githubusercontent.com/ammahmoudi/Handwritten-Digit-Classification/main/cmatrix-480.webp 480w,https://raw.githubusercontent.com/ammahmoudi/Handwritten-Digit-Classification/main/cmatrix-800.webp 800w,https://raw.githubusercontent.com/ammahmoudi/Handwritten-Digit-Classification/main/cmatrix-1400.webp 1400w," sizes="95vw" type="image/webp"></source> <img src="https://raw.githubusercontent.com/ammahmoudi/Handwritten-Digit-Classification/main/cmatrix.png" class="img-fluid rounded z-depth-1" width="100%" height="auto" alt="cmatrix" data-zoomable="" loading="lazy" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> <figure> <picture> <source class="responsive-img-srcset" srcset="https://raw.githubusercontent.com/ammahmoudi/Handwritten-Digit-Classification/main/train_acc-480.webp 480w,https://raw.githubusercontent.com/ammahmoudi/Handwritten-Digit-Classification/main/train_acc-800.webp 800w,https://raw.githubusercontent.com/ammahmoudi/Handwritten-Digit-Classification/main/train_acc-1400.webp 1400w," sizes="95vw" type="image/webp"></source> <img src="https://raw.githubusercontent.com/ammahmoudi/Handwritten-Digit-Classification/main/train_acc.png" class="img-fluid rounded z-depth-1" width="100%" height="auto" alt="train_acc" data-zoomable="" loading="lazy" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> <figure> <picture> <source class="responsive-img-srcset" srcset="https://raw.githubusercontent.com/ammahmoudi/Handwritten-Digit-Classification/main/val_acc-480.webp 480w,https://raw.githubusercontent.com/ammahmoudi/Handwritten-Digit-Classification/main/val_acc-800.webp 800w,https://raw.githubusercontent.com/ammahmoudi/Handwritten-Digit-Classification/main/val_acc-1400.webp 1400w," sizes="95vw" type="image/webp"></source> <img src="https://raw.githubusercontent.com/ammahmoudi/Handwritten-Digit-Classification/main/val_acc.png" class="img-fluid rounded z-depth-1" width="100%" height="auto" alt="val_acc" data-zoomable="" loading="lazy" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> </article> </div> </div> <footer class="fixed-bottom" role="contentinfo"> <div class="container mt-0"> © Copyright 2024 Amirhossein Mahmoudi. Last updated: June 28, 2024. </div> </footer> <script src="https://cdn.jsdelivr.net/npm/jquery@3.6.0/dist/jquery.min.js" integrity="sha256-/xUj+3OJU5yExlq6GSYGSHk7tPXikynS7ogEvDej/m4=" crossorigin="anonymous"></script> <script src="/assets/js/bootstrap.bundle.min.js"></script> <script src="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/js/mdb.min.js" integrity="sha256-NdbiivsvWt7VYCt6hYNT3h/th9vSTL4EDWeGs5SN3DA=" crossorigin="anonymous"></script> <script defer src="https://cdn.jsdelivr.net/npm/masonry-layout@4.2.2/dist/masonry.pkgd.min.js" integrity="sha256-Nn1q/fx0H7SNLZMQ5Hw5JLaTRZp0yILA/FRexe19VdI=" crossorigin="anonymous"></script> <script defer src="https://cdn.jsdelivr.net/npm/imagesloaded@5.0.0/imagesloaded.pkgd.min.js" integrity="sha256-htrLFfZJ6v5udOG+3kNLINIKh2gvoKqwEhHYfTTMICc=" crossorigin="anonymous"></script> <script defer src="/assets/js/masonry.js" type="text/javascript"></script> <script defer src="https://cdn.jsdelivr.net/npm/medium-zoom@1.1.0/dist/medium-zoom.min.js" integrity="sha256-ZgMyDAIYDYGxbcpJcfUnYwNevG/xi9OHKaR/8GK+jWc=" crossorigin="anonymous"></script> <script defer src="/assets/js/zoom.js?85ddb88934d28b74e78031fd54cf8308"></script> <script src="/assets/js/no_defer.js?2930004b8d7fcd0a8e00fdcfc8fc9f24"></script> <script defer src="/assets/js/common.js?da39b660470d1ba6e6b8bf5f37070b6e"></script> <script defer src="/assets/js/copy_code.js?12775fdf7f95e901d7119054556e495f" type="text/javascript"></script> <script defer src="/assets/js/jupyter_new_tab.js?d9f17b6adc2311cbabd747f4538bb15f"></script> <script async src="https://d1bxh8uas1mnw7.cloudfront.net/assets/embed.js"></script> <script async src="https://badge.dimensions.ai/badge.js"></script> <script type="text/javascript">window.MathJax={tex:{tags:"ams"}};</script> <script defer type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3.2.0/es5/tex-mml-chtml.js"></script> <script defer src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script> <script async src="https://www.googletagmanager.com/gtag/js?id=G-TNCS9B9B3L"></script> <script>function gtag(){window.dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],gtag("js",new Date),gtag("config","G-TNCS9B9B3L");</script> <script type="text/javascript">function progressBarSetup(){"max"in document.createElement("progress")?(initializeProgressElement(),$(document).on("scroll",function(){progressBar.attr({value:getCurrentScrollPosition()})}),$(window).on("resize",initializeProgressElement)):(resizeProgressBar(),$(document).on("scroll",resizeProgressBar),$(window).on("resize",resizeProgressBar))}function getCurrentScrollPosition(){return $(window).scrollTop()}function initializeProgressElement(){let e=$("#navbar").outerHeight(!0);$("body").css({"padding-top":e}),$("progress-container").css({"padding-top":e}),progressBar.css({top:e}),progressBar.attr({max:getDistanceToScroll(),value:getCurrentScrollPosition()})}function getDistanceToScroll(){return $(document).height()-$(window).height()}function resizeProgressBar(){progressBar.css({width:getWidthPercentage()+"%"})}function getWidthPercentage(){return getCurrentScrollPosition()/getDistanceToScroll()*100}const progressBar=$("#progress");window.onload=function(){setTimeout(progressBarSetup,50)};</script> </body> </html>